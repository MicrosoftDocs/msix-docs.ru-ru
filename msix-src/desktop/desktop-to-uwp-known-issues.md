---
description: В этой статье описаны известные проблемы, которые могут возникнуть при создании пакета MSIX для классического приложения.
title: Известные проблемы с упакованными классическими приложениями
ms.date: 07/29/2019
ms.topic: article
keywords: windows 10, uwp, msix
ms.assetid: 71f8ffcb-8a99-4214-ae83-2d4b718a750e
ms.localizationpriority: medium
ms.openlocfilehash: 0ec44b40dc377bbc573c40a6ec12540f7cd89dac
ms.sourcegitcommit: e3a06eccd3322053b8b498cb6343fb6f711a7a0b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/12/2020
ms.locfileid: "84724547"
---
# <a name="known-issues-with-packaged-desktop-apps"></a>Известные проблемы с упакованными классическими приложениями

В этой статье приведены сведения об известных проблемах, которые могут возникнуть при создании пакета MSIX для классического приложения.

## <a name="you-receive-the-error----msb4018-the-generateresource-task-failed-unexpectedly"></a>Сообщение об ошибке MSB4018, неожиданный сбой задачи GenerateResource

Это может произойти при попытке преобразования вспомогательных сборок в файлы индекса ресурсов пакетов (PRI).

Мы знаем об этой проблеме и работаем над ее окончательным решением. В качестве временного решения можно отключить генератор ресурсов. Для этого добавьте следующую строку XML в первый элемент PropertyGroup в файле вышестоящего проекта:

``<AppxGeneratePrisForPortableLibrariesEnabled>false</AppxGeneratePrisForPortableLibrariesEnabled>``

## <a name="blue-screen-with-error-code-0x139-kernel_security_check_failure"></a>Синий экран с кодом ошибки 0x139 (KERNEL_SECURITY_CHECK_FAILURE)

После установки или запуска некоторых приложений из Microsoft Store компьютер может неожиданно перезагрузиться. При этом отображается следующее сообщение об ошибке: **0x139 (KERNEL\_SECURITY\_CHECK\_ FAILURE)** .

Известно, что эта проблема затрагивает приложения Kodi, JT2Go, Ear Trumpet, Teslagrad и др.

27.10.2016 г. было выпущено [обновление Windows (версия 14393.351 — KB3197954)](https://support.microsoft.com/kb/3197954), в которое вошли важные исправления, направленные на решение этой проблемы. Если вы столкнулись с этой проблемой, обновите свой компьютер. Если вам не удается обновить компьютер, потому что он перезапускается до того, как вам удается войти в систему, восстановите систему до точки более ранней, чем установка одного из затрагиваемых проблемой приложений. О том, как восстановить систему, см. в статье [Параметры восстановления в Windows 10](https://support.microsoft.com/help/12415/windows-10-recovery-options).

Если обновление не устраняет проблему или вы не знаете, как восстановить компьютер, обратитесь в [службу поддержки Майкрософт](https://support.microsoft.com/contactus/).

Если вы разработчик, вы можете запретить установку своих упакованных приложений в версиях Windows, в которых нет этого обновления. Обратите внимание, что при этом ваше приложение не будет доступно пользователям, которые еще не установили обновление. Чтобы сделать приложением доступным только пользователям, которые установили обновления, внесите в файл AppxManifest.xml следующие исправления:

```<TargetDeviceFamily Name="Windows.Desktop" MinVersion="10.0.14393.351" MaxVersionTested="10.0.14393.351"/>```

Подробнее о Центре обновления Windows можно прочитать по следующим ссылкам:
* https://support.microsoft.com/kb/3197954
* https://support.microsoft.com/help/12387/windows-10-update-history

## <a name="common-errors-that-can-appear-when-you-sign-your-app"></a>Распространенные ошибки, которые могут появиться при входе в приложение

### <a name="publisher-and-cert-mismatch-causes-signtool-error-error-signersign-failed--21470248850x8007000b"></a>Несоответствие издателя и сертификата приводит к ошибке SignTool: SignerSign() Failed" (-2147024885/0x8007000b)

Запись издателя в манифесте пакета приложения для Windows должна соответствовать субъекту сертификата, с помощью которого выполняется подписывание.  Вы можете использовать любой из следующих методов для просмотра субъекта сертификата.

**Вариант 1. PowerShell**

Выполните следующую команду PowerShell: В качестве файла сертификата можно использовать как .cer, так и .pfx, так как они содержат идентичные сведения об издателе.

```ps
(Get-PfxCertificate <cert_file>).Subject
```

**Вариант 2. Проводник**

Дважды щелкните сертификат в проводнике, выберите вкладку *Сведения*, а затем выберите поле *Субъект* в списке. Скопируйте его содержимое.

**Вариант 3. certutil**

Запустите **certutil** из командной строки в PFX-файле и скопируйте поле *Subject* из выходных данных.

```cmd
certutil -dump <cert_file.pfx>
```

<a id="bad-pe-cert"></a>

### <a name="bad-pe-certificate-0x800700c1"></a>Неправильный сертификат PE (0x800700C1)

Это может произойти, если пакет содержит двоичный файл с поврежденным сертификатом. Вот некоторые из причин:

* Начало сертификата находится не в конце образа.  

* Размер сертификата не положительный.

* Сертификат начинается не после структуры `IMAGE_NT_HEADERS32` для 32-разрядного исполняемого файла или структуры `IMAGE_NT_HEADERS64` для 64-разрядного исполняемого файла.

* Указатель сертификата не согласован должным образом для структуры WIN_CERTIFICATE.

Чтобы найти файлы, содержащие неправильный сертификат PE, откройте **командную строку** и задайте для переменной среды с именем `APPXSIP_LOG` значение 1.

```
set APPXSIP_LOG=1
```

Затем в **командной строке** еще раз подпишите приложение. Например:

```
signtool.exe sign /a /v /fd SHA256 /f APPX_TEST_0.pfx C:\Users\Contoso\Desktop\pe\VLC.appx
```

Сведения о файлах, содержащих неправильный сертификат PE, отобразятся в **окне консоли**. Например:

```
...

ERROR: [AppxSipCustomLoggerCallback] File has malformed certificate: uninstall.exe

...   
```

## <a name="next-steps"></a>Дальнейшие действия

Есть вопросы? Задайте их на Stack Overflow. Наша команда следит за этими [тегами](https://stackoverflow.com/questions/tagged/project-centennial+or+desktop-bridge). Вы также можете задать нам вопросы [здесь](https://social.msdn.microsoft.com/Forums/en-US/home?filter=alltypes&sort=relevancedesc&searchTerm=%5BDesktop%20Converter%5D).
