---
title: Рекомендации по использованию средства упаковки MSIX
description: В статье описано, как повторно упаковывать приложения в формате MSIX с помощью средства упаковки MSIX.
ms.date: 09/07/2018
ms.topic: article
keywords: windows 10, uwp, msix
ms.localizationpriority: medium
ms.custom: RS5
ms.openlocfilehash: 00c3831995383cea4b558c6353f4b545ae5b94ac
ms.sourcegitcommit: 0bd5ebc32feba8a4f4669f232129a8953d5cf773
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/15/2020
ms.locfileid: "76022008"
---
# <a name="best-practices-for-the-msix-packaging-tool"></a>Рекомендации по использованию средства упаковки MSIX

<div class="nextstepaction"><p><a class="x-hidden-focus" href="https://www.microsoft.com/en-us/p/msix-packaging-tool/9n5lw3jbcxkf" data-linktype="external">Получить средство упаковки MSIX</a></p></div>

В статье описано, как повторно упаковывать приложения в формате MSIX с помощью средства упаковки MSIX.

## <a name="best-practices-for-environment-setup"></a>Рекомендации по настройке среды
 
Убедитесь, что у вас установлена [Последняя версия средства упаковки MSIX](mpt-overview.md#latest-public-version---1201912200). Перед тем как приступить к процессу преобразования, необходимо продумать ряд моментов.

- Минимальным требованием к версии ОС для средства упаковки MSIX является Windows 10 1809. Мы понимаем, что не у всех установлено обновление Windows 10 за октябрь 2018 г. или просто Windows 10. Поэтому рекомендуется создать виртуальную машину с минимальной поддержкой MSIX.

- Чистая машина для преобразования важна, так как на этапе установки преобразования с помощью средства упаковки MSIX мы будем ожидать все на компьютере, чтобы записать, что делает установщик, и поможет предотвратить получение лишних данных в пакеты. Чистый компьютер означает, что на компьютере не выполняются внешние приложения или службы. Мы рекомендуем настроить компьютер преобразования для имитации среды, в которой будет выполняться пакет MSIX, поэтому при наличии служб или политик, которые будут использоваться, можно проверить, действительно ли пакет будет работать.

- Если это не так, мы предлагаем **Быстрое создание виртуальной машины**с помощью [средства упаковки MSIX](quick-create-vm.md) в Hyper-V, готового к преобразованию с помощью Windows 10 1809 и последней версии средства упаковки MSIX. 

- Следуйте рекомендациям по настройке средства упаковки MSIX, а затем создайте контрольную точку для виртуальной машины. Таким образом, вы можете использовать виртуальную машину для преобразования, вернуться к предыдущей контрольной точке, и она будет чистой, настроенной машиной, готовой к преобразованию, или проверке успешного преобразования пакета MSIX.

- Полезно также выяснить зависимости вашего приложения, чтобы понять, какие из них следует запускать с приложением, а какие нужно упаковать в виде пакета изменений. Например, существующие зависимости среды выполнения рекомендуется включать в основное приложение. Если у вас есть подключаемый модуль, следует упаковать его как пакет изменений, чтобы связать его с основным приложением. 

## <a name="best-practices-for-setting-up-the-msix-packaging-tool"></a>Рекомендации по настройке средства упаковки MSIX

Прежде чем приступать к преобразованию, мы рекомендуем настроить параметры в средстве упаковки MSIX, чтобы упростить рабочий процесс каждый раз. 

### <a name="tool-defaults"></a>Параметры по умолчанию для инструментов
- **Создание командной строки с каждым пакетом** Этот параметр сделает так, чтобы автоматически создавался файл командной строки, чтобы при повторном упаковке одного и того же приложения (например, новой версии) в командной строке можно было настроить предварительно настроенный файл командной строки для этого приложения. 
- **По умолчанию выбрать все исправления для подготовки компьютера** Этот параметр позволяет выбрать предварительно выбранные исправления, чтобы на этапе подготовки компьютера можно было просто отключить все, не выполняя выбор по отдельности.
- **Принудительное соблюдение требований к версии Microsoft Store** Если вы планируете развертывать приложение с помощью Microsoft Store, следует убедиться, что оно соответствует требованиям к магазину (это повлияет на требования к версии пакета и минимальную поддержку версий ОС). Если этот параметр не установлен, для пакета будет установлена минимальная версия Windows 10 1709, и вы получите полный контроль над 4 цифрами версии пакета. Если этот флажок установлен, для пакета будет установлена минимальная версия Windows 10 1809, а версия должна заканчиваться на. 0 (например, 1.5.6.0).
- **Добавление целостности пакета при создании пакета** Если выбран этот параметр, целостность пакетов будет автоматически добавлена во все создаваемые пакеты. Однако он будет применяться только к пакетам, если целостность пакетов поддерживается в ОС, в которой они развернуты. 
- **Расположение сохранения по умолчанию** Укажите место сохранения по умолчанию, в котором будут сохраняться созданные пакеты и связанные файлы.
- **Расположение программы установки по умолчанию** Укажите расположение по умолчанию, в котором нужно найти установщики для преобразования.
- **Номер порта сервера** Укажите номер порта сервера для инструмента упаковки MSIX. Это уместно, если вы планируете преобразовать с помощью [удаленного компьютера](https://docs.microsoft.com/windows/msix/packaging-tool/remote-conversion-setup). 
- **Предпочтения среды** Укажите среду по умолчанию для каждого преобразования.
- **Параметры подписывания** Укажите параметр по умолчанию для подписывания при преобразовании приложений. Для установки необходимо подписать пакет MSIX. Вы можете выбрать один из нескольких вариантов подписывания.
    - Подпишитесь с помощью подписи Device Guard. Этот вариант рекомендуется, если у вас нет доверенного сертификата на предприятии. Дополнительные сведения о настройке подписывания Device Guard см. здесь. 
    - Подпишитесь с помощью сертификата (PFX). Этот вариант рекомендуется, если у вас уже есть доверенный сертификат, который используется в вашей организации.
    - Укажите CER-файл (не подписывается). Если вы не хотите подписываться во время преобразования, но хотите убедиться, что сведения об издателе будут действительны во время подписания, можно выбрать этот параметр.
    - Не подписывать пакет. — Если вы хотите подписать пакет с помощью другого метода или позже после создания пакета, можно выбрать этот параметр.

Также рекомендуется добавить URL-адрес сервера меток времени к предпочтениям сигинг (если применимо), чтобы приложение можно было установить даже в случае истечения срока действия сертификата.
 
 ### <a name="other-settings"></a>Другие параметры
 - **Екслусионс файлов и реестра** Хотя у нас есть набор исключаемых элементов по умолчанию, мы рекомендуем рассмотреть и добавить или удалить любые исключаемые элементы для конкретных нужд. 
 - **Коды завершения установщика** Если у вас есть определенные коды выхода установщика, которые необходимо активировать для перезапуска во время преобразования, их можно указать здесь. По умолчанию мы уже добавили общие шаблоны, но их можно удалить, если вы никогда не хотите запускать перезагрузку. Обратите внимание, что при использовании пользовательского интерфейса средство упаковки никогда не активирует перезагрузку автоматически, но если вы используете параметр командной строки, это приведет к автоматическому запуску программы. 
 
 Вы также можете импортировать или экспортировать параметры для совместного использования или обеспечения соответствия между одноранговыми узлами с помощью этих [инструкций](https://docs.microsoft.com/windows/msix/packaging-tool/duplicate-mpt-settings-across-devices). 

## <a name="best-practices-during-repackaging"></a>Рекомендации по повторной упаковке

При использовании средства упаковки MSIX существует несколько вещей, которые мы рекомендуем использовать в процессе переупаковки.

- При упаковке установщиков ClickOnce необходимо отправлять ярлык на рабочий стол, если установщик не предусматривает выполнение такой операции. В целом рекомендуется всегда отправлять на рабочий стол ярлык исполняемого файла основного приложения.
- При создании пакетов изменений необходимо объявить имя пакета (имя удостоверения) родительского приложения в пользовательском интерфейсе средства, чтобы средство правильно установило зависимость пакета в манифесте пакета изменения.
- Выполнение подготовительных действий на странице **Подготовка компьютера** является необязательным, но настоятельно рекомендуется, так как это поможет уменьшить излишние данные в пакете. 
- Необходимо подписать пакет, чтобы установить его, но мы также рекомендуем отметку времени сертификата, чтобы приложение можно было установить даже в случае истечения срока действия сертификата. 
- Объявление поля расположения установки на странице **сведений о пакете** является необязательным. Убедитесь, что этот путь совпадает с расположением установки установщика приложений.

## <a name="best-practices-while-bundling-msix-packages"></a>Рекомендации по объединению пакетов MSIX

Мы рекомендуем объединять пакеты MSIX, если для приложения используются разные установщики для разных архитектур процессоров (x86, x64, ARM). Объединение установщиков в пакет позволяет ОС Windows 10 определять подходящий установщик вместо пользователя. 

При объединении [пакетов MSIX](https://docs.microsoft.com/windows/msix/packaging-tool/bundle-msix-packages)необходимо, чтобы установщики Win32 уже были преобразованы в пакеты MSIX. 

- Средство упаковки MSIX учитывает архитектуру процессора той версии ОС Windows 10, в которой выполняется преобразование. Так, если преобразование 32-разрядного установщика (x86) выполняется в 64-разрядной версии Windows 10, будет создана 64-разрядная версия (x64) пакета MSIX. 
- Если вы планируете объединить пакеты MSIX, преобразование установщиков необходимо выполнять в той среде, в которой они будут развернуты. Это позволит средству упаковки MSIX создать соответствующий пакет MSIX для этой среды. 

## <a name="best-practices-for-testing-your-msix-package"></a>Рекомендации по тестированию пакета MSIX

Мы рекомендуем также протестировать пакет MSIX после преобразования в чистой среде, как было указано выше во время настройки среды. Необходимо протестировать пакет MSIX на другом компьютере, на котором не установлен предыдущий установщик, чтобы гарантировать, что при развертывании пакета MSIX он будет иметь все необходимые компоненты и не будет выполнять выбор из предыдущего установщика. Это можно сделать с помощью новой виртуальной машины, например, с помощью быстрого создания ВИРТУАЛЬНОЙ машины, или путем восстановления компьютера преобразования, если следовать рекомендациям по контрольной точке выше.

