---
title: Создание пакета MSIX с помощью классического установщика (MSI, EXE или App-V) на виртуальной машине
description: Создание пакета MSIX с помощью классического установщика (MSI, EXE или App-V) на виртуальной машине
ms.date: 02/11/2019
ms.topic: article
keywords: Windows 10, uwp
ms.localizationpriority: medium
ms.custom: RS5
ms.openlocfilehash: e9cd7b8967c65f9cfcc4fb11d66650975b6bbda9
ms.sourcegitcommit: 71c49de79d061909fb1ab632ec7550227d2287bd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2020
ms.locfileid: "75754888"
---
# <a name="create-an-msix-package-from-a-desktop-installer-msi-execlickonce-or-app-v"></a>Создание пакета MSIX из установщика настольных систем (MSI, EXE, ClickOnce или App-V)

<div class="nextstepaction"><p><a class="x-hidden-focus" href="https://www.microsoft.com/en-us/p/msix-packaging-tool/9n5lw3jbcxkf" data-linktype="external">Получить средство упаковки MSIX</a></p></div>

С помощью [средства упаковки MSIX](../mpt-overview.md) можно создать пакет приложения MSIX на основе существующего установщика MSI, exe, ClickOnce или App-v на виртуальной машине Hyper-v (ВМ). Виртуальная машина должна соответствовать следующим требованиям:

Мы рекомендуем использовать [рекомендации](https://docs.microsoft.com/windows/msix/packaging-tool/mpt-best-practices) по настройке среды и средству упаковки MSIX для преобразования. 

> [!NOTE]
> Сейчас средство упаковки MSIX поддерживает App-V 5.1. Если у вас есть пакеты с App-V 4.x, рекомендуем преобразовать их в пакеты App-V 5.1, прежде чем использовать средство упаковки MSIX для преобразования в MSIX. 

При первом запуске средства вам будет предложено предоставить свое согласие на отправку данных телеметрии. Важно отметить, что диагностические данные, которые вы предоставляете нам, генерируются самим приложением и не используются для вашей идентификации или попыток связаться с вами.

Создание пакета приложения — это самый популярный вариант. Здесь вы создадите пакет MSIX из установщика или [вручную путем установки](https://docs.microsoft.com/windows/msix/packaging-tool/create-other-installer) полезных данных приложения.

![pic1](images/pic1.PNG)

## <a name="packaging-method"></a>Метод упаковки

Выберите вариант для компьютера преобразования:
- Если вы уже работаете в чистой среде, выберите **создать пакет на этом компьютере** .
- Если вы хотите подключиться к существующей виртуальной машине или удаленному компьютеру, щелкните **Создать пакет на удаленном компьютере.**
  - Необходимо [настроить удаленный компьютер](https://docs.microsoft.com/windows/msix/packaging-tool/remote-conversion-setup) , чтобы его можно было преобразовать.
- Если на компьютере есть локальная виртуальная машина, которую нужно преобразовать, щелкните **Создать пакет на локальной виртуальной машине**.
  - Нажмите кнопку **Далее**.
  
## <a name="prepare-computer"></a>Подготовка компьютера

На странице **Подготовка компьютера** доступны параметры для подготовки компьютера к созданию пакета.

Требуется **драйвер средства упаковки MSIX** , и средство автоматически попытается включить его, если оно не включено. Сначала будет выполнена проверка с использованием DISM, чтобы определить, установлен ли драйвер. Если возникла проблема, попробуйте проверить нашу [документацию по устранению неполадок](https://docs.microsoft.com/windows/msix/packaging-tool/mpt-known-issues), а затем при повторении ошибки Выполняйте запись в [центр обратной связи](https://docs.microsoft.com/windows/msix/packaging-tool/mpt-known-issues#sending-feedback) . 

> [!NOTE]
> Драйвер средства упаковки MSIX отслеживает состояние системы и регистрирует изменения, которые установщик вносит в систему. Средство упаковки MSIX затем учитывает эти изменения при создании пакета.

**Центр обновления Windows активна** Мы временно отключим Центр обновления Windows на время упаковки, чтобы не собираются лишние данные. 

- Флажок **Ожидается перезагрузка** по умолчанию не установлен. При появлении сообщения о том, что для операции в состоянии ожидания требуется перезагрузка компьютера, вам нужно вручную будет сделать это. Это действие является не обязательным, а рекомендуемым.

- [Необязательно.] Установите флажок **Windows Search is Active** (Служба Windows Search активна) и щелкните **Disable selected** (Отключить выбранные), если вы хотите отключить службу поиска.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на **Отключено**.

- Используемых Установите флажок для **узла SMS активен** и выберите **отключить выбранный** , если вы решили отключить службу узла.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на **Отключено**.

Завершив подготовку компьютера, щелкните **Далее**.

## <a name="choose-the-installer-you-want-to-package"></a>Выбор установщика, с помощью которого нужно создать пакет

Перейдите к MSI, App-V или другому установщику Win 32, нажав кнопку **Обзор** и выбрав установщик в средстве выбора файлов.

Если у вас есть аргументы установщика, можно ввести нужный аргумент в указанное поле. В поле можно ввести любую строку.

В разделе **предпочтения подписи**выберите вариант подписывания. Вы можете определить в параметрах этот вариант как вариант по умолчанию, чтобы автоматизировать выполнение некоторых шагов при каждом преобразовании. 
- **Подписать с помощью подписи Device Guard** Этот параметр позволяет войти в учетную запись Microsoft Active Directory, настроенную для использования с подписыванием Device Guard, которое является службой подписи, которую корпорация Майкрософт предоставляет, где вам не нужно предоставлять собственный сертификат. Дополнительные сведения о настройке учетной записи и о подписывании Device Guard см. [здесь](https://docs.microsoft.com/windows/msix/package/signing-package-device-guard-signing). 
- **Подписывание с помощью сертификата (PFX)** Найдите и выберите PFX-файл сертификата. Если сертификат защищен паролем, введите пароль в соответствующем поле.
- **Укажите CER-файл (имеет знак примечания)** Этот параметр позволяет указать CER-файл. Это полезно, если вы не хотите подписывать пакет, но хотите убедиться, что сведения об издателе соответствуют субъекту сертификата, который будет использоваться для подписания. 
- **Не подписывать пакет** Выберите этот параметр, если вы будете подписаны пакет позднее. Примечание. невозможно установить пакет MSIX, если он не подписан
- При подписывании мы настоятельно рекомендуем добавить к сертификату **метку времени** , чтобы срок действия вашего сертификата мог быть последним. Допустимый формат — [URL-адрес сервера меток времени](https://docs.microsoft.com/windows/win32/seccrypto/signtool) в соответствии со стандартом RFC 3161. 

Чтобы продолжить, нажмите кнопку **Далее**.

## <a name="package-information"></a>Сведения о пакете

Чтобы упаковать приложение на существующей виртуальной машине, вам нужно указать сведения об этом приложении. Средство попытается автоматически заполнить эти поля, используя данные, которые предоставляет установщик. При необходимости вы сможете в любой момент обновить эти записи. Если поле отмечено знаком звездочки (*), оно является обязательным (но вы и так это знаете). Если введены недопустимые данные, отобразится встроенная справка.
- Имя пакета:
    - Является обязательным и соответствует имени идентификатора пакета в манифесте. Предназначено для описания содержимого пакета.
    - Должно совпадать с именем, которое указано в сведениях о субъекте сертификата, используемого для подписывания пакета.
    - Не отображается пользователю.
    - Следует учитывать регистр и не использовать пробелы.
    - Допускаются строки длиной 3–50 символов, включающие буквенно-цифровые символы, точки и дефисы.
    - Не может заканчиваться точкой и иметь один из следующих: CON, PRN, AUX, NUL "," COM1 "," COM2 "," COM3 "," COM4 "," COM5 "," COM6 "," COM7 "," COM8 "," COM9 "," LPT1 "," LPT2 "," LPT3 "," LPT4 "," LPT5 "," LPT6 "," LPT7 "," LPT8 "и" LPT9 ".
- Отображаемое имя пакета:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного имени пакета пользователю в меню "Пуск" и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Имя издателя:
    - Является обязательным и соответствует пакету с описанием сведений об издателе.
    - Атрибут Publisher должен совпадать со сведениями о субъекте издателя сертификата, используемого для подписывания пакета.
    - Допускается строка длиной 1–8192 символа, которая может содержать регулярное выражение различающегося имени: (CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")(, ((CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")))*.
- Отображаемое имя издателя:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного пользователю имени издателя в Установщике приложений и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Версия:
    - Является обязательной и соответствует пакету в манифесте. Предназначена для описания номера версии пакета.
    - Это поле принимает строку версии в нотации Quad: "основная. Дополнительная. сборка. Редакция".
- Расположение установки:
    - Это расположение, в которое установщик скопирует полезные данные приложения (обычно это папка Program Files).
    - Является необязательным, но рекомендуемым, особенно если полезные данные приложения устанавливаются в другой папке (не в Program Files).
    - Найдите и выберите путь к папке.
    - При установке приложения убедитесь, что этот файл совпадает с расположением для установки установщика.
- Описание:
    - Это поле является необязательным. 

## <a name="installation"></a>Установка

- Это этап установки, на котором средство отслеживает операции установки приложения и собирает данные о них.
- Средство запустит установщик в окне виртуальной машины, которое откроется на начальном этапе, после чего вам потребуется выполнить инструкции мастера, чтобы установить приложение.
    - Убедитесь, что путь установки совпадает с путем, который был определен ранее на странице со сведениями о пакете.
    - Вам потребуется создать ярлык на рабочем столе для установленного приложения.
    - После завершения работы с мастером установки приложения убедитесь, что вы выполнили все операции или закрыли его.
    - Если вам необходимо запустить несколько установщиков, на этом этапе вы можете сделать это вручную.
    - Если для работы приложения нужны другие обязательные компоненты, установите их сейчас.
    - Если приложению необходимо использовать .Net 3.5/20, добавьте этот компонент в Windows.
- Если установщик требует перезагрузки, можно выполнить перезагрузку вручную или нажать кнопку "перезапустить", чтобы выполнить перезагрузку, после чего вы вернетесь к этому моменту в процессе преобразования после перезапуска.
- После завершения установки приложения нажмите кнопку **Далее**.

## <a name="manage-first-launch-tasks"></a>Управление первыми задачами запуска

На этой странице отображаются исполняемые файлы приложения, зарегистрированные средством. Мы рекомендуем запустить приложение хотя бы один раз для регистрации первых задач запуска.

При наличии нескольких приложений установите соответствующий флажок для главной точки входа. Если исполняемый файл приложения здесь не отображается, найдите и запустите его вручную.

Щелкните **Далее**. Отобразится всплывающее окно, и вам нужно будет подтвердить, что вы завершили установку приложения и управление первыми задачами запуска.
- Если вы готовы продолжить работу, щелкните **Yes, move on** (Да, продолжить).
- В противном случае щелкните **No, I'm not done** (Нет, пока не продолжать). Вы будете перенаправлены на последнюю страницу, где можно запускать приложения, устанавливать или копировать другие файлы, в том числе библиотеки DLL и исполняемые файлы.

## <a name="create-package"></a>Создание пакета

- Укажите расположение для сохранения пакета MSIX.
- По умолчанию пакеты сохраняются в локальной папке данных приложений.
- Вы можете задать расположение для сохранения пакетов по умолчанию в меню "Параметры".
- Если вы хотите продолжить редактирование содержимого и свойств перед сохранением пакета MSIX, вы можете нажать кнопку "Редактор пакетов", чтобы перейти к редактору.
- Щелкните **Создать**, чтобы создать пакет MSIX.

После создания пакета отобразится всплывающее окно. Оно будет содержать сведения об имени, издателе и расположении сохранения созданного пакета. После закрытия этого окна вы будете перенаправлены на страницу приветствия. Вы также можете запустить [редактор пакетов](https://docs.microsoft.com/windows/msix/packaging-tool/package-editor), чтобы просмотреть и изменить содержимое и свойства пакета.

