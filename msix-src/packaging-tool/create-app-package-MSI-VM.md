---
title: Создание пакета MSIX с помощью классического установщика (MSI, EXE или App-V) на виртуальной машине
description: Создание пакета MSIX с помощью классического установщика (MSI, EXE или App-V) на виртуальной машине
author: mcleanbyron
ms.author: mcleans
ms.date: 02/11/2019
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.custom: RS5
ms.openlocfilehash: 2997fa46ebf2c7c027d20772e619234a93a821e6
ms.sourcegitcommit: 52010495873758d9bfe7a9fb0b240108b25b3d3c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/03/2019
ms.locfileid: "67555579"
---
# <a name="create-an-msix-package-from-a-desktop-installer-msi-exe-or-app-v-on-a-vm"></a>Создание пакета MSIX с помощью классического установщика (MSI, EXE или App-V) на виртуальной машине

<div class="nextstepaction"><p><a class="x-hidden-focus" href="https://www.microsoft.com/en-us/p/msix-packaging-tool/9n5lw3jbcxkf" data-linktype="external">Получить средство упаковки MSIX</a></p></div>

Вы можете использовать [средство упаковки MSIX](../mpt-overview.md) для создания пакета приложения MSIX с помощью существующего установщика MSI, EXE или App-V на виртуальной машине Hyper-V. Виртуальная машина должна соответствовать следующим требованиям:

- Она должна быть настроена на [получение удаленных команд](https://docs.microsoft.com/windows-server/virtualization/hyper-v/manage/remotely-manage-hyper-v-hosts) (выполните команду [Enable-PSRemoting](https://docs.microsoft.com/powershell/module/Microsoft.PowerShell.Core/Enable-PSRemoting?view=powershell-5.1) на виртуальной машине).
- Требуется ОС Windows 10, версия 1809 и выше.

> [!NOTE]
> Сейчас средство упаковки MSIX поддерживает App-V 5.1. Если у вас есть пакеты с App-V 4.x, рекомендуем преобразовать их в пакеты App-V 5.1, прежде чем использовать средство упаковки MsIX для преобразования в MSIX. 

При первом запуске средства вам будет предложено предоставить свое согласие на отправку данных телеметрии. Важно отметить, что диагностические данные, которые вы предоставляете нам, генерируются самим приложением и не используются для вашей идентификации или попыток связаться с вами. Они помогают нам быстрее устранять проблемы.

Создание пакета приложения — это самый популярный вариант. Он предполагает создание пакета MSIX с помощью установщика или путем установки полезных данных приложения вручную.

![pic1](images/pic1.png)

## <a name="choose-the-installer-you-want-to-package"></a>Выбор установщика, с помощью которого нужно создать пакет

![pic2](images/pic2.png)

Перейдите к установщику MSI или App-V, щелкнув **Обзор** и выбрав установщик в средстве выбора файлов. Затем нажмите кнопку **Далее**.

Дополнительные возможности:
- Установите флажок для параметра **Use existing MSIX package** (Использовать существующий пакет MSIX), найдите и выберите существующий пакет MSIX для обновления.
- Установите флажок для параметра **Use installer arguments** (Использовать аргументы установщика) и введите нужные аргументы в соответствующем поле. В поле можно ввести любую строку.
- Установите флажок для параметра **Sign package for testing** (Подписать пакет для тестирования), найдите PFX-файл сертификата и выберите его. Если сертификат защищен паролем, введите пароль в соответствующем поле.

## <a name="packaging-method"></a>Метод упаковки

![images/pic3](images/pic3.png)

- Выберите виртуальную машину для среды упаковки.
  - Выберите **Create package on an existing virtual machine** (Создать пакет на существующей виртуальной машине) и в раскрывающемся списке выберите имя существующей виртуальной машины. Отобразятся поля для ввода учетных данных (имени пользователя и пароля) виртуальной машины (при их наличии).
  - Нажмите кнопку **Далее**.

## <a name="package-information"></a>Сведения о пакете

![images/pic4](images/pic4.png)

Чтобы упаковать приложение на существующей виртуальной машине, вам нужно указать сведения об этом приложении. Средство попытается автоматически заполнить эти поля, используя данные, которые предоставляет установщик. При необходимости вы сможете в любой момент обновить эти записи. Если поле отмечено знаком звездочки (*), оно является обязательным (но вы и так это знаете). Если введены недопустимые данные, отобразится встроенная справка.
- Имя пакета:
    - Является обязательным и соответствует имени идентификатора пакета в манифесте. Предназначено для описания содержимого пакета.
    - Должно совпадать с именем, которое указано в сведениях о субъекте сертификата, используемого для подписывания пакета.
    - Не отображается пользователю.
    - Следует учитывать регистр и не использовать пробелы.
    - Допускаются строки длиной 3–50 символов, включающие буквенно-цифровые символы, точки и дефисы.
    - Не может заканчиваться точкой и иметь такие значения: CON, PRN, AUX, NUL, COM1, COM2, COM3, COM4, COM5, COM6, COM7, COM8, COM9, LPT1, LPT2, LPT3, LPT4, LPT5, LPT6, LPT7, LPT8 и LPT9.
- Отображаемое имя пакета:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного имени пакета пользователю в меню "Пуск" и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Имя издателя:
    - Является обязательным и соответствует пакету с описанием сведений об издателе.
    - Атрибут Publisher должен совпадать со сведениями о субъекте издателя сертификата, используемого для подписывания пакета.
    - Допускается строка длиной 1–8192 символа, которая может содержать регулярное выражение различающегося имени: (CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")(, ((CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")))*.
- Отображаемое имя издателя:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного пользователю имени издателя в Установщике приложений и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Версия:
    - Является обязательной и соответствует пакету в манифесте. Предназначена для описания номера версии пакета.
    - Допускается строка с версией в формате четырехкомпонентной системы обозначений: основная.вспомогательная.сборка.редакция.
- Расположение установки:
    - Это расположение, в которое установщик скопирует полезные данные приложения (обычно это папка Program Files).
    - Является необязательным, но рекомендуемым, особенно если полезные данные приложения устанавливаются в другой папке (не в Program Files).
    - Найдите и выберите путь к папке.
    - При установке приложения убедитесь, что этот файл совпадает с расположением для установки установщика.

## <a name="prepare-computer"></a>Подготовка компьютера

![images/pic5](images/pic5.png)

На странице **Подготовка компьютера** доступны параметры для подготовки компьютера к созданию пакета.

Средство упаковки MSIX попытается автоматически включить требуемый соответствующий драйвер, если он не включен. Сначала будет выполнена проверка с использованием DISM, чтобы определить, установлен ли драйвер.

> [!NOTE]
> Драйвер средства упаковки MSIX отслеживает состояние системы и регистрирует изменения, которые установщик вносит в систему. Средство упаковки MSIX затем учитывает эти изменения при создании пакета.

- [Необязательно.] Установите флажок **Windows Search is Active** (Служба Windows Search активна) и щелкните **Disable selected** (Отключить выбранные), если вы хотите отключить службу поиска.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на "Отключено".

- [Необязательно.] Установите флажок **Windows Update is Active** (Обновление Windows активно) и щелкните **Disable selected** (Отключить выбранные), если вы хотите отключить службу обновления.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на **Отключено**.

- Флажок **Ожидается перезагрузка** по умолчанию не установлен. При появлении сообщения о том, что для операции в состоянии ожидания требуется перезагрузка компьютера, вам нужно вручную будет сделать это. Это действие является не обязательным, а рекомендуемым.

Завершив подготовку компьютера, щелкните **Далее**.

## <a name="installation"></a>Установка

![images/pic6](images/pic6.png)

> [!NOTE]
> Во время преобразования установщики могут запускать службы. Данные служб не собираются во время преобразования. В результате ваше приложение может быть установлено, но при работе могут возникать проблемы.

- Это этап установки, на котором средство отслеживает операции установки приложения и собирает данные о них.
- Средство запустит установщик в окне виртуальной машины, которое откроется на начальном этапе, после чего вам потребуется выполнить инструкции мастера, чтобы установить приложение.
    - Убедитесь, что путь установки совпадает с путем, который был определен ранее на странице со сведениями о пакете.
    - Вам потребуется создать ярлык на рабочем столе для установленного приложения.
    - После завершения работы с мастером установки приложения убедитесь, что вы выполнили все операции или закрыли его.
    - Если вам необходимо запустить несколько установщиков, на этом этапе вы можете сделать это вручную.
    - Если для работы приложения нужны другие обязательные компоненты, установите их сейчас.
    - Если приложению необходимо использовать .Net 3.5/20, добавьте этот компонент в Windows.
- После завершения установки приложения нажмите кнопку **Далее**.

## <a name="manage-first-launch-tasks"></a>Управление первыми задачами запуска

![images/pic7](images/pic7.png)

На этой странице отображаются исполняемые файлы приложения, зарегистрированные средством. Мы рекомендуем запустить приложение хотя бы один раз для регистрации первых задач запуска.

При наличии нескольких приложений установите соответствующий флажок для главной точки входа. Если исполняемый файл приложения здесь не отображается, найдите и запустите его вручную.

Щелкните **Далее**. Отобразится всплывающее окно, и вам нужно будет подтвердить, что вы завершили установку приложения и управление первыми задачами запуска.
- Если вы готовы продолжить работу, щелкните **Yes, move on** (Да, продолжить).
- В противном случае щелкните **No, I'm not done** (Нет, пока не продолжать). Вы будете перенаправлены на последнюю страницу, где можно запускать приложения, устанавливать или копировать другие файлы, в том числе библиотеки DLL и исполняемые файлы.

## <a name="create-package"></a>Создание пакета

![images/pic8](images/pic8.png)

- Укажите расположение для сохранения пакета MSIX.
- По умолчанию пакеты сохраняются в локальной папке данных приложений.
- Вы можете задать расположение для сохранения пакетов по умолчанию в меню "Параметры".
- Если вы хотите продолжить редактирование содержимого и свойств перед сохранением пакета MSIX, вы можете нажать кнопку "Редактор пакетов", чтобы перейти к редактору.
- Если же вы хотите подписать пакет с помощью готового сертификата для тестирования, найдите и выберите сертификат.
- Щелкните **Создать**, чтобы создать пакет MSIX.

После создания пакета отобразится всплывающее окно. Оно будет содержать сведения об имени, издателе и расположении сохранения созданного пакета. После закрытия этого окна вы будете перенаправлены на страницу приветствия. Вы также можете запустить редактор пакетов, чтобы просмотреть и изменить содержимое и свойства пакета.

