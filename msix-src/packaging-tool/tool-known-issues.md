---
title: Известные проблемы и советы по устранению неполадок средства упаковки MSIX
description: Описание известных проблем и рекомендации по устранению неполадок, которые следует учитывать при преобразовании приложений в MSIX с помощью средства упаковки MSIX.
ms.date: 06/11/2020
ms.topic: article
keywords: msix packaging tool, known issues, troubleshooting
ms.localizationpriority: medium
ms.custom: RS5
ms.openlocfilehash: 0c432cd0bd02d68f52034f5f392a1f16e9f552ab
ms.sourcegitcommit: 6b1ec6420dbaa327b65c208b4cd00da87985104b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/29/2020
ms.locfileid: "89090772"
---
# <a name="known-issues-and-troubleshooting-tips-for-the-msix-packaging-tool"></a>Известные проблемы при работе со средством упаковки MSIX и советы по их устранению

В этой статье описаны известные проблемы, возникающие при преобразовании приложений в формат MSIX с помощью средства упаковки MSIX, и приведены рекомендации по их устранению. Ознакомьтесь с другими документами, если вам нужно получить средство упаковки MSIX или драйвер в [отключенных средах](disconnected-environment.md).

## <a name="known-issues"></a>Известные проблемы

### <a name="getting-the-latest-insider-preview-build-of-the-msix-packaging-tool"></a>Получение последней предварительной сборки предварительной версии средства упаковки MSIX

Если вы выбрали [программу предварительной оценки](insider-program.md), убедитесь, что у вас установлена правильная версия средства упаковки MSIX:
- Перейдите к разделу **About** в средстве упаковки MSIX, чтобы просмотреть версию, на которой вы используете.
- Перейдите [сюда](insider-program.md#current-insider-preview-build) , чтобы определить последнюю предварительную версию предварительной версии и убедиться, что установлена эта версия средства упаковки MSIX. 
- Убедитесь, что в системе MSA, которая зарегистрирована для рейса, выбрана учетная запись, которая входит в Microsoft Store. 
- Вручную обновите средство упаковки MSIX с помощью Microsoft Store на компьютере. Если этот параметр доступен, откройте магазин, перейдите в раздел **загрузки и обновления**и нажмите кнопку **получить обновления**. Кроме того, можно найти средство упаковки MSIX, а на странице продукта вы можете запросить обновление. 
- Чтобы установить средство упаковки MSIX для использования в автономном режиме, выполните следующие [инструкции](disconnected-environment.md#get-the-msix-packaging-tool) , чтобы получить последнюю версию приложения с помощью нашего автономного процесса.

Если вы хотите присоединиться к программе предварительной оценки, щелкните [здесь](https://aka.ms/MSIXPackagingPreviewProgram).

### <a name="msix-packaging-tool-driver"></a>Драйвер средства упаковки MSIX

Драйвер средства упаковки MSIX поставляется как пакет по [запросу (FOD)](/windows-hardware/manufacture/desktop/features-on-demand-v2--capabilities) от Центр обновления Windows. Установка не будет выполнена, если на компьютере отключена служба Центр обновления Windows или если параметры Microsoft Windows для рейсов не соответствуют сборке ОС компьютера.

Если у вас возникли проблемы с получением драйвера или вы работаете в автономной среде, можно найти ссылки для скачивания [драйвера.](disconnected-environment.md#get-the-msix-packaging-tool-driver) 

Если вы скачали драйвер и используете проблемы во время преобразования пакета, возможно, это может быть одна из следующих проблем.

#### <a name="network-connectivity-issues"></a>Проблемы, связанные с подключением к сети

Следующие коды ошибок могут означать, что возникли проблемы с подключением:

* -2145107924 (0x8024402C)
* -2145107945 (0x80244017)
* -2145123272 (0x80240438)

#### <a name="windows-server-update-service-wsus-configuration-manager-or-group-policies-affecting-windows-update-connectivity"></a>Службы Windows Server Update Service (WSUS), Configuration Manager или групповые политики, влияющие на Центр обновления Windows подключение

Следующий код ошибки может указывать на то, что политики на вашем компьютере влияют на Центр обновления Windows подключение:-2145124306 (0x8024002e).

Если вы получаете этот код ошибки, возможно, потребуется проверить [Параметры среды и политики](/windows/deployment/update/fod-and-lang-packs).

#### <a name="driver-required-a-reinstall"></a>Драйвер требует переустановки

В этом сценарии средство упаковки MSIX уведомляет вас в сообщении об ошибке и записывает, что драйвер нуждается в перезагрузке. Перезагрузите компьютер и снова запустите преобразование, чтобы устранить эту проблему. 

### <a name="minimum-version"></a>Минимальная версия

Существует несколько функций, которые следует учитывать, что автоматически изменяет поддержку версии минимальные в пакете MSIX. 

#### <a name="enforce-microsoft-store-versioning-requirements"></a>Обеспечить соблюдение требований к версии Microsoft Store
Если вы преобразуете существующий установщик с помощью версии [средства упаковки MSIX](tool-overview.md) , предшествующего **1.2019.701.0**, средство применяет требования Microsoft Store управления версиями к или использует другое средство для создания пакета, который не устанавливал минимальную версию 10.0.16299.0 (Windows 10, версия 1709). Это приведет к появлению сообщения об ошибке при развертывании приложения в Windows 10, версии 1709 или более поздней версии.

Чтобы устранить эту проблему, откройте **средство упаковки MSIX** и измените приложение с помощью **редактора пакетов**. Откройте манифест и присвойте `MinVersion` атрибуту элемента значение `TargetDeviceFamily` «10.0.16299.0».

```xml
<Dependencies>
    <TargetDeviceFamily> Name="Windows.Desktop" MinVersion="10.0.16299.0" MaxVersionTested = "10.0.17763.0" />
</Dependencies>
```

#### <a name="msix-with-services"></a>MSIX со службами
В версии 1.2019.1220.0 средства упаковки MSIX добавлена поддержка создания [пакета MSIX со службами](convert-an-installer-with-services.md). Из-за ограничений операционной системы, поддерживаемых службами, средство упаковки MSIX автоматически изменяет версию min, поддерживаемую в пакете MSIX, с помощью служб на 10.0.19025.0. Это означает, что вы не можете установить MSIX со службами в ОС ниже версии 2004, но вы можете создать эту MSIX, используя средство упаковки MSIX в Windows 10 1809. Если необходимо установить это приложение на более ранней ОС, обновите минимальную версию, но обратите внимание, что поддержка служб не будет работать.

### <a name="frameworks-and-drivers"></a>Платформы и драйверы

Если приложению требуется платформа, убедитесь, что платформа установлена на этапе мониторинга преобразования. Просмотрите журналы, чтобы убедиться, что это происходит. Если приложению требуется установить драйвер, необходимо оценить, требуется ли это для работы приложения должным образом. MSIX в настоящее время не поддерживает установку драйверов.

### <a name="remote-machine"></a>Удаленный компьютер
Если при выполнении преобразований с помощью удаленной виртуальной машины возникают проблемы, см. [инструкции по установке для преобразования удаленных компьютеров](remote-conversion-setup.md).

### <a name="issues-during-conversion"></a>Проблемы во время преобразования
- Некоторые установщики могут завершать преобразование со сбоем и выдачей кода завершения 259. Такой код означает, что установщик создал поток и не дождался завершения его работы. То есть основной поток выполнил установку, но завершил работу с ошибкой 259, так как им был создан поток, который еще выполняется. В таком случае мы рекомендуем использовать соответствующий параметр установки для приложения setup.exe.

### <a name="issues-during-signing"></a>Проблемы при подписывании

#### <a name="bad-pe-certificate-0x800700c1"></a>Сертификат неверного PE (0x800700C1)

Эта проблема возникает, когда пакет содержит двоичный файл с поврежденным сертификатом. Чтобы устранить эту проблему, используйте `dumpbin.exe /headers` команду, чтобы создать дамп заголовков файлов и проверить наличие неверных элементов. Вручную Перепишите заголовки, чтобы устранить проблему. Как правило, средство упаковки MSIX автоматически обнаруживает неправильные заголовки. Если проблема не исчезнет, то обратимся к файлу. Дополнительные сведения см. [здесь](../desktop/desktop-to-uwp-known-issues.md#bad-pe-certificate-0x800700c1).

#### <a name="device-guard-signing"></a>Подпись Device Guard

Обязательно выполните [эти действия](../package/signing-package-device-guard-signing.md) и назначьте соответствующие роли в Microsoft Store для бизнеса.

#### <a name="expired-certificate"></a>Срок действия сертификата истек.

- При подписывании пакета используйте метку времени.
- Вы можете подписать действительный сертификат или подпись отметки времени.

Вы можете повторно подписать приложение с помощью [скрипта преобразования пакетной](https://github.com/microsoft/MSIX-Toolkit/tree/master/Scripts)службы.

## <a name="troubleshooting"></a>Устранение неполадок

### <a name="log-files"></a>Файлы журнала

Файлы журналов создаются для всех операций преобразований, независимо от их успешности. Их можно найти по такому пути:

`%localappdata%\packages\Microsoft.MsixPackagingTool_8wekyb3d8bbwe\LocalState\DiagOutputDir\`

В журналах записываются коды ошибок, которые указывают на точку отказа в процессе преобразования. Коды ошибок должны быть понятны пользователям.

#### <a name="log-files-from-remote-devices-or-vms"></a>Файлы журналов с удаленных устройств или виртуальных машин

Если преобразование выполняется на удаленном устройстве или виртуальной машине, мы рекомендуем вам скопировать файлы журналов с такого устройства и вложить их при отправке отчета. Это позволит нам более эффективно провести диагностику и устранить проблему.

Журналы удаленного преобразования можно найти по этому пути: `%localappdata%\packages\Microsoft.MsixPackagingTool_8wekyb3d8bbwe\LocalState\DiagOutputDir\<Logs_#>\RemoteServer\Log.txt`

Это еще более выгодно, если вы можете предоставить общий доступ к папке журналов, в которую будут входить операции, выполняемые на локальном клиенте, а также на удаленном сервере.

### <a name="common-problems"></a>Распространенные проблемы

#### <a name="makeprimanifest-translation-errors"></a>Ошибки преобразования передаваемые программе MakePRI/manifest

Эта ошибка возникает, если возникла проблема с манифестом пакета. Чтобы узнать причину проблемы, перейдите в редактор пакетов и откройте манифест. При открытии манифеста можно найти проблему и предоставить соответствующее исправление.

#### <a name="file-not-found"></a>Файл не найден

Возможно, файл открыт или не существует. Чтобы устранить эту проблему, добавьте соответствующий файл или закройте файл, который используется в данный момент. Обратите внимание, что `File not Found` если она открыта, возникнет ошибка. Вместо этого вы получите `Access Denied` `File in Use` ошибку или.

#### <a name="file-type-associations"></a>Сопоставления типов файлов

Проблемы, касающиеся сопоставлений типов файлов (ФТА), зависят от пакета и пакета. Средство упаковки MSIX поддерживает сопоставление файлов для установки двойного щелчка. Например, если приложение имеет контекстное меню, оно не добавляется автоматически, поэтому его необходимо добавить в манифест вручную. Пример см. в элементе манифеста [desktop4: филиксплорерконтекстменус](/uwp/schemas/appxpackage/uapmanifestschema/element-desktop4-fileexplorercontextmenus) .

#### <a name="shortcuts-with-arguments"></a>Сочетания клавиш с аргументами

В настоящее время в MSIX не поддерживаются сочетания клавиш с аргументами. Если мы обнаружите, что установщик включает эти данные, MSIX создаст плитку без аргументов.

#### <a name="install-directory"></a>Каталог установки

Это наиболее распространено для тех, кто использует вторичный диск для выполнения преобразований приложений. Если вы решили изменить расположение установки, то изменится корневой каталог, в который будут переходить все файлы. Это означает, что инструменту упаковки MSIX необходимо знать, где находятся все эти файлы и которые будут записываться во время преобразования. 

Это можно исправить, используя пакет поддержки Write для установки исправления каталога. Мы добавили это как возможность по умолчанию в средстве MSIX, что позволяет перейти на 1809. Если приложение не работает в 1709 и находится в 1809, это, скорее всего, проблема.

## <a name="sending-feedback"></a>Отправка отзыва

Лучший способ отправить отзыв — через [**центр обратной связи**](https://www.microsoft.com/p/feedback-hub/9nblggh4r32n?activetab=pivot:overviewtab).

1. Откройте **Центр отзывов** или нажмите клавиши **Windows+F**.
2. Введите название и шаги для воспроизведения проблемы.
3. В разделе **Категория** выберите **Приложения** и **MSIX Packaging Tool** (Средство упаковки MSIX).
4. Вложите [файлы журналов](#log-files) преобразования. Журналы можно найти в указанной выше папке.
5. Вложите преобразованный пакет MSIX (если это возможно).
6. Щелкните **Отправить**.

Вы также можете отправить отчет непосредственно из средства упаковки MSIX, перейдя на вкладку **Отзыв** в окне **Параметры**. 

> [!NOTE]
> На доставку отчета может потребоваться до 24 часов. Поэтому если для преобразования пакета вы используете виртуальную машину, мы рекомендуем оставить ее включенной и поддерживать ее текущее состояние в течение 24 часов после преобразования. Кроме того, можно вручную присоединить журналы преобразования к обратной связи.