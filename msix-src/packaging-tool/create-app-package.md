---
title: Создание пакета MSIX из любого классического установщика
description: Создание пакета MSIX из любого настольного установщика (MSI, EXE, ClickOnce или App-V)
ms.date: 02/11/2019
ms.topic: article
keywords: windows 10, uwp
ms.localizationpriority: medium
ms.custom: RS5
ms.openlocfilehash: 125dd3dab5fc2884b48dceeac1006614156a8ba8
ms.sourcegitcommit: fa41875f6c2b79db3d7dde29b10c0f24765532bc
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2020
ms.locfileid: "79097896"
---
# <a name="create-an-msix-package-from-any-desktop-installer-msi-exe-clickonce-or-app-v"></a>Создание пакета MSIX из любого настольного установщика (MSI, EXE, ClickOnce или App-V)

<div class="nextstepaction"><p><a class="x-hidden-focus" href="https://www.microsoft.com/en-us/p/msix-packaging-tool/9n5lw3jbcxkf" data-linktype="external">Получить средство упаковки MSIX</a></p></div>

С помощью [средства упаковки MSIX](tool-overview.md) можно создать пакет приложения MSIX из любого из следующих вариантов:

- MSI
- EXE
- ClickOnce
- App-V
- Сценарий
- Установка вручную

В этом документе вы узнаете, как взять имеющиеся активы и преобразовать их в MSIX.

Прежде чем приступить к преобразованию, рекомендуется убедиться, что вы [понимаете ваш установщик](know-your-installer.md)и будет ли он преобразован.

Мы также рекомендуем использовать рекомендации по [настройке среды](prepare-your-environment.md) и [средству упаковки MSIX](tool-best-practices.md) для преобразования.

> [!NOTE]
> Сейчас средство упаковки MSIX поддерживает App-V 5.1. Если у вас есть пакет с App-V 4. x, мы рекомендуем использовать исходный установщик для преобразования в MSIX.

При первом запуске средства вам будет предложено предоставить свое согласие на отправку данных телеметрии. Важно отметить, что диагностические данные, которые вы предоставляете нам, генерируются самим приложением и не используются для вашей идентификации или попыток связаться с вами.

Наиболее часто используемый вариант — создание **пакета приложения** . Здесь вы создадите пакет MSIX из установщика или вручную путем установки полезных данных приложения.

![pic1](images/pic1.PNG)

## <a name="packaging-method"></a>Метод упаковки

Выберите вариант для компьютера преобразования:

- Если вы уже работаете в чистой среде, выберите **создать пакет на этом компьютере** .
- Если вы хотите подключиться к существующему виртуальному или удаленному компьютеру, выберите команду **создать пакет на удаленном компьютере** .
  - Необходимо [настроить удаленный компьютер](remote-conversion-setup.md) , чтобы его можно было преобразовать.
- Если на компьютере есть локальная виртуальная машина, которую требуется преобразовать, выберите **создать пакет на локальной виртуальной машине** .
  - Обратите внимание, что мы поддерживаем только виртуальные машины Hyper-V. Если вы хотите использовать другой продукт виртуализации, можно подключиться с помощью параметра удаленный компьютер.

- Нажмите кнопку **Далее**.
  
## <a name="prepare-computer"></a>Подготовка компьютера

На странице **Подготовка компьютера** доступны параметры для подготовки компьютера к созданию пакета.

Требуется **драйвер средства упаковки MSIX** , и средство автоматически попытается включить его, если оно не включено. Сначала будет выполнена проверка с использованием DISM, чтобы определить, установлен ли драйвер. Если возникла проблема, попробуйте проверить нашу [документацию по устранению неполадок](tool-known-issues.md), а затем при повторении ошибки Выполняйте запись в [центр обратной связи](tool-known-issues.md#sending-feedback) .

> [!NOTE]
> Драйвер средства упаковки MSIX отслеживает состояние системы и регистрирует изменения, которые установщик вносит в систему. Средство упаковки MSIX затем учитывает эти изменения при создании пакета.

**Центр обновления Windows активна** Мы временно отключим Центр обновления Windows на время упаковки, чтобы не собираются лишние данные.

- Флажок **Ожидается перезагрузка** по умолчанию не установлен. При появлении сообщения о том, что для операции в состоянии ожидания требуется перезагрузка компьютера, вам нужно вручную будет сделать это. Это действие является не обязательным, а рекомендуемым.

- [Необязательно.] Установите флажок **Windows Search is Active** (Служба Windows Search активна) и щелкните **Disable selected** (Отключить выбранные), если вы хотите отключить службу поиска.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на **Отключено**.

- Используемых Установите флажок для **узла SMS активен** и выберите **отключить выбранный** , если вы решили отключить службу узла.
    - Это действие является не обязательным, а рекомендуемым.
    - После отключения значение поля состояния для средства изменится на **Отключено**.

Завершив подготовку компьютера, щелкните **Далее**.

## <a name="choose-the-installer-you-want-to-package"></a>Выбор установщика, с помощью которого нужно создать пакет

Первое, что нужно сделать, это понять, что произойдет с установщиком, который вы хотите преобразовать. С помощью любого из этих установщиков можно указать их здесь, чтобы упростить рабочий процесс, или запустить его вручную во время установки позже в рабочем процессе.

### <a name="msi-installers"></a>Установщики MSI

При преобразовании установщика. msi можно просто найти его и указать MSI-файл. Если у вас есть сопутствующий файл. MST или. MSP, можно указать это в поле аргументы установщика. Одним из преимуществ указания файла. MSI является то, что мы можем извлечь из него всю информацию о пакете, сохранив время на следующем шаге преобразования.

### <a name="app-v-installers"></a>Установщики App-V

При преобразовании с помощью App-V это действительно простой процесс. Необходимо только указать файл App-V, и вы сможете быстро отслеживание на странице Создание MSIX. Это обусловлено тем, что манифест пакета просто нужно перевести в пакет MSIX, а затем просто работает как MSIX. Здесь следует помнить, что средство поддерживает только App-V 5,1. Если приложение-V имеет версию 4. x, рекомендуется взять исходный установщик и преобразовать его непосредственно в MSIX.

### <a name="exe-installers"></a>Установщики EXE

Если выполняется преобразование exe-файла установщика, на этом этапе можно указать установщик. В связи с отсутствием согласованности формата с exe-файла необходимо вручную ввести сведения о пакете для установщика. 

### <a name="clickonce-installers"></a>Установщики ClickOnce

При преобразовании установщика ClickOnce на этом этапе можно указать установщик. Как и exe, необходимо вручную ввести сведения о пакете для установщика. 

### <a name="scripts"></a>Сценарии
Если вы используете сценарий для установки приложения, можно указать командную строку здесь. Кроме того, это поле можно оставить пустым и запустить сценарий вручную на [этапе установки](#installation).

### <a name="manual-installation"></a>Установка вручную
Если вы хотите вручную запустить установщик или вручную выполнить действия установщика, можно оставить поле установщика пустым и на [этапе установки](#installation)выполнить действия, необходимые для установщика. 

Если вы пытаетесь создать файл шаблона преобразования, вы не сможете сделать это без указания установщика.

Если у вас есть аргументы установщика, можно ввести нужный аргумент в указанное поле. В поле можно ввести любую строку.

### <a name="signing-preference"></a>Параметры подписывания 

В разделе **предпочтения подписи**выберите вариант подписывания. Вы можете определить в параметрах этот вариант как вариант по умолчанию, чтобы автоматизировать выполнение некоторых шагов при каждом преобразовании.

- **Подписать с помощью подписи Device Guard** Этот параметр позволяет войти в учетную запись Microsoft Active Directory, настроенную для использования с подписыванием Device Guard, которое является службой подписи, которую корпорация Майкрософт предоставляет, где вам не нужно предоставлять собственный сертификат. Дополнительные сведения о настройке учетной записи и о подписывании Device Guard см. [здесь](../package/signing-package-device-guard-signing.md). 
- **Подписывание с помощью сертификата (PFX)** Найдите и выберите PFX-файл сертификата. Если сертификат защищен паролем, введите пароль в соответствующем поле.
- **Укажите CER-файл (имеет знак примечания)** Этот параметр позволяет указать CER-файл. Это полезно, если вы не хотите подписывать пакет, но хотите убедиться, что сведения об издателе соответствуют субъекту сертификата, который будет использоваться для подписания. 
- **Не подписывать пакет** Выберите этот параметр, если вы будете подписаны пакет позднее. Примечание. невозможно установить пакет MSIX, если он не подписан
- При подписывании мы настоятельно рекомендуем добавить к сертификату **метку времени** , чтобы срок действия вашего сертификата мог быть последним. Допустимый формат — [URL-адрес сервера меток времени](https://docs.microsoft.com/windows/win32/seccrypto/signtool) в соответствии со стандартом RFC 3161.

> Метим Подписывание приложения формата пакета MSIX с использованием сертификата SHA1 не поддерживается.

Чтобы продолжить, нажмите кнопку **Далее**.

## <a name="package-information"></a>Сведения о пакете

Чтобы упаковать приложение на существующей виртуальной машине, вам нужно указать сведения об этом приложении. Средство попытается автоматически заполнить эти поля, используя данные, которые предоставляет установщик. При необходимости вы сможете в любой момент обновить эти записи. Если поле отмечено знаком звездочки (*), это значит, что оно является обязательным. Если введены недопустимые данные, отобразится встроенная справка.

- Имя пакета:
    - Является обязательным и соответствует имени идентификатора пакета в манифесте. Предназначено для описания содержимого пакета.
    - Должно совпадать с именем, которое указано в сведениях о субъекте сертификата, используемого для подписывания пакета.
    - Не отображается пользователю.
    - Следует учитывать регистр и не использовать пробелы.
    - Допускаются строки длиной 3–50 символов, включающие буквенно-цифровые символы, точки и дефисы.
    - Не может заканчиваться точкой и иметь один из следующих: CON, PRN, AUX, NUL "," COM1 "," COM2 "," COM3 "," COM4 "," COM5 "," COM6 "," COM7 "," COM8 "," COM9 "," LPT1 "," LPT2 "," LPT3 "," LPT4 "," LPT5 "," LPT6 "," LPT7 "," LPT8 "и" LPT9 ".
- Отображаемое имя пакета:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного имени пакета пользователю в меню "Пуск" и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Имя издателя:
    - Является обязательным и соответствует пакету с описанием сведений об издателе.
    - Атрибут Publisher должен совпадать со сведениями о субъекте издателя сертификата, используемого для подписывания пакета.
    - Допускается строка длиной 1–8192 символа, которая может содержать регулярное выражение различающегося имени: (CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")(, ((CN | L | O | OU | E | C | S | STREET | T | G | I | SN | DC | SERIALNUMBER | Description | PostalCode | POBox | Phone | X21Address | dnQualifier | (OID.(0 | [1-9][0-9])(.(0 | [1-9][0-9]))+))=(([^,+="<>#;])+ | ".")))*.
- Отображаемое имя издателя:
    - Является обязательным и соответствует пакету в манифесте. Предназначено для отображения понятного пользователю имени издателя в Установщике приложений и на страницах параметров.
    - Допускается строка длиной 1–256 символов и поддерживается локализация.
- Версия:
    - Является обязательной и соответствует пакету в манифесте. Предназначена для описания номера версии пакета.
    - Это поле принимает строку версии в нотации Quad: "основная. Дополнительная. сборка. Редакция".
- Расположение установки:
    - Это расположение, в которое установщик скопирует полезные данные приложения (обычно это папка Program Files).
    - Это поле является необязательным, но рекомендуется при установке полезных данных приложения за пределами папок Program Files.
    - Найдите и выберите путь к папке.
    - При установке приложения убедитесь, что этот файл совпадает с расположением для установки установщика.
- Описание:
    - Это поле является необязательным. 

## <a name="installation"></a>Установка

- Это этап установки, на котором средство отслеживает и записывает операции установки приложения.
- Средство запустит установщик в среде, указанной ранее, и для установки приложения необходимо пройти мастер установки.
    - Убедитесь, что путь установки совпадает с путем, который был определен ранее на странице со сведениями о пакете.
    - Для вновь установленного приложения может потребоваться создать ярлык на рабочем столе.
    - После завершения работы с мастером установки приложения убедитесь, что вы выполнили все операции или закрыли его.
    - Если вам необходимо запустить несколько установщиков, на этом этапе вы можете сделать это вручную.
    - Если приложению требуются другие предварительные требования, их необходимо установить сейчас.
    - Если приложению необходимо использовать .Net 3.5/20, добавьте этот компонент в Windows.
- Если вы ранее не указали установщик, то можете вручную запустить установщик или сценарий.
- Если [установщик требует перезагрузки](support-restart.md), можно выполнить перезагрузку вручную или нажать кнопку "перезапустить", чтобы выполнить перезагрузку, после чего вы вернетесь к этому моменту в процессе преобразования после перезапуска.
- После завершения установки приложения нажмите кнопку **Далее**.

## <a name="manage-first-launch-tasks"></a>Управление первыми задачами запуска

На этой странице отображаются исполняемые файлы приложения, зарегистрированные средством. Мы рекомендуем запустить приложение хотя бы один раз для регистрации первых задач запуска.

Чтобы запустить исполняемый файл, выберите его и нажмите кнопку **выполнить**. Можно также удалить все ненужные точки входа, выбрав ее, а затем нажав кнопку **Удалить**.

При наличии нескольких приложений установите соответствующий флажок для главной точки входа. Если исполняемый файл приложения здесь не отображается, найдите и запустите его вручную. Затем **Обновите список**.

Щелкните **Далее**. Отобразится всплывающее окно, и вам нужно будет подтвердить, что вы завершили установку приложения и управление первыми задачами запуска.

- Если вы готовы продолжить работу, щелкните **Yes, move on** (Да, продолжить).
- В противном случае щелкните **No, I'm not done** (Нет, пока не продолжать). Вы будете перенаправлены на последнюю страницу, где можно запускать приложения, устанавливать или копировать другие файлы, в том числе библиотеки DLL и исполняемые файлы.

## <a name="services-report"></a>Отчет о службах

Начиная с версии 1.2019.1220.0 средства упаковки MSIX, можно преобразовать [установщик со службами](convert-an-installer-with-services.md), и поэтому мы добавили страницу отчета службы. Если службы не обнаружены, вы по-прежнему увидите эту страницу, но она будет пустой с сообщением о том, что в верхней части страницы не обнаружены службы. 

На странице отчета службы перечислены службы, обнаруженные в установщике во время преобразования. Службы, которые имеют всю необходимую информацию и поддерживаются, будут показаны в **прилагаемой** таблице. В **исключенной** таблице будут показаны службы, для которых требуется дополнительная информация, требуется исправление или не поддерживается.

Чтобы исправить службу или просмотреть дополнительные данные о службе, дважды щелкните запись службы в таблице, чтобы просмотреть всплывающее окно с дополнительными сведениями о службе. Некоторые из этих сведений можно изменить при необходимости.

- **Имя ключа:** Имя службы. Это недоступно для редактирования.
- **Описание:** Описание записи службы.
- **Отображаемое имя:** Отображаемое имя службы.
- **Путь к изображению:** Расположение исполняемого файла службы. Это недоступно для редактирования.
- **Начальная учетная запись:** Начальная учетная запись для службы.
- **Тип запуска:** Тип запуска службы. Поддерживает **Автоматические**, **Ручные**и **Отключенные**.
- **Аргументы:** Аргументы, которые будут запускаться при запуске службы.
- **Зависимости:** Зависимости для службы.

После того как служба будет исправлена, ее можно переместить в **включенную** таблицу или оставить в **исключенной** таблице, если ее не нужно использовать в окончательном пакете. Дополнительные сведения см. в документации по [службам](convert-an-installer-with-services.md).

## <a name="create-package"></a>Создание пакета

- Укажите расположение для сохранения пакета MSIX.
- По умолчанию пакеты сохраняются в локальной папке данных приложений.
- Вы можете задать расположение для сохранения пакетов по умолчанию в меню "Параметры".
- Если создается файл шаблона преобразования, можно также указать другое расположение для сохранения этого файла шаблона, если оно не должно находиться в том же расположении, что и пакет MSIX.
- Если вы хотите продолжить редактирование содержимого и свойств пакета перед сохранением пакета MSIX, можно выбрать [редактор пакетов](package-editor.md) и перейти в редактор пакетов.
- Щелкните **Создать**, чтобы создать пакет MSIX.

При создании пакета появится всплывающее окно. Это всплывающее окно будет содержать расположение сохранения, связанное с расположением файла только что созданного пакета. Он также содержит ссылку на расположение файлов журнала для средства упаковки MSIX. После закрытия этого окна вы будете перенаправлены на страницу приветствия. Вы также можете запустить [редактор пакетов](package-editor.md), чтобы просмотреть и изменить содержимое и свойства пакета.
